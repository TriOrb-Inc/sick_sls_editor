<!doctype html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SICK SLS Editor (Web)</title>
  <link
    rel="icon"
    type="image/png"
    href="{{ url_for('static', filename='favicon.ico') }}"
  />
  <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
  <style>
    :root {
      color-scheme: light;
      font-family: "Segoe UI", "Yu Gothic UI", system-ui, -apple-system, sans-serif;
    }


    body {
      margin: 0;
      background: #eef1f5;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #0b6fb8;
      color: #fff;
      padding: 1rem 1.5rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    header p {
      margin: 0.2rem 0 0;
    }

    main {
      width: 95%;
      margin: 2rem auto;
      padding: 1.5rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(15, 23, 42, 0.1);
      flex: 1;
      display: flex;
      gap: 1.5rem;
      align-items: flex-start;
    }

    .content-area {
      flex: 1 1 65%;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .side-menu {
      flex: 0 0 360px;
      max-height: calc(100vh - 4rem);
      overflow-y: auto;
      padding-right: 0.5rem;
      position: sticky;
      top: 2rem;
      align-self: flex-start;
    }

    .side-menu::-webkit-scrollbar {
      width: 6px;
    }

    .side-menu::-webkit-scrollbar-thumb {
      background: rgba(15, 23, 42, 0.25);
      border-radius: 3px;
    }

    .toolbar {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: flex-start;
    }

    .toolbar-primary {
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
    }

    .toolbar-toggle {
      width: 100%;
      display: flex;
      justify-content: flex-start;
    }

    button,
    label.upload-btn,
    .inline-btn {
      border: none;
      border-radius: 6px;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      cursor: pointer;
      background: #0b6fb8;
      color: #fff;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.2);
    }

    .legend-toggle-btn {
      background: #475569;
      font-size: 0.75rem;
      padding: 0.35rem 0.75rem;
      color: #e2e8f0;
    }

    button.secondary {
      background: #475569;
    }

    .inline-btn.inline-danger {
      background: #c53030;
    }

    label.upload-btn {
      position: relative;
    }

    label.upload-btn input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    #status-text {
      margin-left: auto;
      font-size: 0.9rem;
      color: #475569;
    }

    #status-text[data-state="error"] {
      color: #c53030;
    }

    #status-text[data-state="warning"] {
      color: #d97706;
    }

    .plot-wrapper {
      width: 100%;
      max-width: none;
      min-height: 420px;
    }

    #plot {
      width: 100%;
      min-height: 520px;
      height: clamp(420px, 65vh, 900px);
    }

    .fieldset-filter {
      margin-top: 1rem;
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      padding: 0.75rem;
      background: #f8fafc;
    }

    .fieldset-filter-controls {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }

    #fieldset-checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem 1rem;
    }

    .fieldset-checkbox {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.9rem;
    }

    .triorb-shape-filter {
      margin-top: 1rem;
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      padding: 0.75rem;
      background: #f1f5f9;
    }

    .triorb-structure-actions {
      margin-top: 0.75rem;
      display: flex;
      justify-content: flex-start;
    }

    .triorb-shape-checkbox {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.9rem;
    }

    .side-menu {
      flex: 0 0 auto;
      min-width: 220px;
      max-width: 40%;
      width: fit-content;
      background: #f6f8fb;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.05);
    }

    .side-menu h2 {
      font-size: 1rem;
      margin: 0 0 0.75rem;
      color: #1f2937;
    }

    .menu-section {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 8px;
      margin-bottom: 0.5rem;
      background: #fff;
    }

    .menu-section summary {
      cursor: pointer;
      padding: 0.6rem 0.8rem;
      font-weight: 600;
      color: #0b6fb8;
      list-style: none;
    }

    .menu-section summary::-webkit-details-marker {
      display: none;
    }

    .menu-section summary::after {
      content: "+";
      float: right;
      font-weight: normal;
      color: #64748b;
    }

    .menu-section[open] summary::after {
      content: "-";
    }

    .menu-content {
      padding: 0.6rem 0.8rem 1rem;
      color: #475569;
      font-size: 0.9rem;
      border-top: 1px solid rgba(15, 23, 42, 0.06);
    }

    .menu-description {
      margin: 0 0 0.6rem;
      color: #1f2937;
      font-weight: 500;
    }

    .menu-fileinfo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.7rem 1rem;
    }

    .menu-fileinfo-field label {
      display: block;
      margin-bottom: 0.25rem;
      font-size: 0.8rem;
      font-weight: 600;
      color: #475569;
    }

    .menu-fileinfo-field input {
      width: 100%;
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.45rem 0.6rem;
      font-size: 0.9rem;
      background: #fff;
    }

    .triorb-field label {
      display: block;
      margin-bottom: 0.25rem;
      font-size: 0.8rem;
      font-weight: 600;
      color: #475569;
    }

    .triorb-field input,
    .triorb-field select {
      width: 100%;
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.45rem 0.6rem;
      font-size: 0.9rem;
      background: #e6f2ff;
    }

    .menu-fileinfo-field input:focus,
    .scanplane-card input:focus,
    .device-card input:focus,
    .fieldset-field input:focus,
    .field-attribute input:focus {
      outline: 2px solid rgba(11, 111, 184, 0.35);
      border-color: rgba(11, 111, 184, 0.65);
    }

    .scanplanes-editor {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .scanplane-card,
    .device-card {
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      padding: 0.6rem;
      background: #fefefe;
    }

    .scanplane-details summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #0b6fb8;
      cursor: pointer;
    }

    .scanplane-details summary::-webkit-details-marker {
      display: none;
    }

    .scanplane-summary {
      font-size: 0.85rem;
      color: #475569;
    }

    .scanplane-fields,
    .device-fields {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 0.4rem 0.6rem;
    }

    .scanplane-field,
    .device-field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .scanplane-field label,
    .device-field label {
      margin-bottom: 0.2rem;
      font-weight: 600;
      color: #475569;
    }

    .scanplane-field input,
    .device-field input {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
    }

    .device-card {
      margin-top: 0.5rem;
      background: #fff;
    }

    .device-details summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: #334155;
      cursor: pointer;
    }

    .device-details summary::-webkit-details-marker {
      display: none;
    }

    .device-summary {
      font-size: 0.8rem;
      color: #64748b;
    }

    select {
      background: #e6f2ff;
    }

    .fieldsets-editor {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .casetable-section {
      margin-top: 1rem;
      padding: 0.75rem;
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      background: #f8fafc;
    }

    .casetable-section h3 {
      margin: 0 0 0.5rem;
      font-size: 1rem;
      color: #0d4b91;
    }

    .casetable-fields-configuration {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .fields-config-note {
      font-size: 0.85rem;
      color: #475569;
      margin: 0 0 0.5rem;
    }

    .casetable-config-form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: 0.75rem;
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 8px;
      background: #fff;
    }

    .casetable-config-field {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .casetable-config-field label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #475569;
    }

    .casetable-config-field-input {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.15);
      padding: 0.4rem 0.6rem;
      background: #fff;
      font-size: 0.9rem;
    }

    .casetable-config-static-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(44px, 1fr));
      gap: 0.4rem;
    }

    .casetable-config-static-btn {
      border-radius: 5px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      font-weight: 600;
      font-size: 0.9rem;
      background: #f1f5f9;
      color: #0f172a;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease;
    }

    .casetable-config-static-btn.is-active {
      background: #0b6fb8;
      color: #fff;
      border-color: #0b6fb8;
    }

    .casetable-config-toggle-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .casetable-config-toggle {
      border-radius: 999px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.9rem;
      font-size: 0.85rem;
      font-weight: 600;
      background: #f1f5f9;
      color: #0f172a;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease;
    }

    .casetable-config-toggle.is-active {
      background: #0b6fb8;
      border-color: #0b6fb8;
      color: #fff;
    }

    .casetable-config-tree {
      margin-top: 0.75rem;
    }

    .fields-config-node details {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 6px;
      padding: 0.35rem 0.5rem;
      background: #fff;
    }

    .fields-config-node summary {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      align-items: center;
      font-weight: 600;
      color: #0f172a;
      cursor: pointer;
    }

    .fields-config-node summary::-webkit-details-marker {
      display: none;
    }

    .fields-config-tag {
      font-size: 0.9rem;
    }

    .fields-config-attrs {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      font-size: 0.75rem;
      color: #475569;
    }

    .fields-config-attr {
      background: #e2e8f0;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
    }

    .fields-config-leaf {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      align-items: center;
      padding: 0.25rem 0.5rem;
      background: #fff;
      border: 1px dashed rgba(15, 23, 42, 0.1);
      border-radius: 6px;
    }

    .fields-config-value {
      font-size: 0.85rem;
      color: #0f172a;
    }

    .fields-config-children {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      margin-top: 0.4rem;
      margin-left: 0.5rem;
      padding-left: 0.5rem;
      border-left: 2px solid rgba(15, 23, 42, 0.08);
    }

    .fields-config-text {
      font-size: 0.85rem;
      color: #475569;
      margin: 0.3rem 0;
    }

    .casetable-configuration details {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 6px;
      padding: 0.4rem 0.6rem;
      background: #fff;
      margin-bottom: 0.5rem;
    }

    .casetable-configuration summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: #0f172a;
      cursor: pointer;
    }

    .casetable-config-attrs {
      margin-top: 0.5rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 0.5rem;
    }

    .casetable-config-attrs label {
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 0.15rem;
      color: #475569;
    }

    .casetable-config-attrs input,
    .casetable-config-attrs textarea {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
      width: 100%;
    }

    .casetable-config-text {
      min-height: 60px;
      resize: vertical;
    }

    .casetable-cases-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .casetable-case-count {
      margin-left: auto;
      font-size: 0.85rem;
      color: #475569;
    }

    .casetable-cases-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .casetable-case-card {
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      background: #fff;
    }

    .casetable-case-card summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      color: #0d4b91;
      cursor: pointer;
    }

    .casetable-case-card summary::-webkit-details-marker {
      display: none;
    }

    .casetable-evals-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .casetable-eval-count {
      margin-left: auto;
      font-size: 0.85rem;
      color: #475569;
    }

    .casetable-evals-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .casetable-eval-card {
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      background: #fff;
    }

    .casetable-eval-card summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      color: #0d4b91;
      cursor: pointer;
    }

    .casetable-eval-card summary::-webkit-details-marker {
      display: none;
    }

    .casetable-eval-body {
      padding: 0.5rem 0.75rem 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .casetable-eval-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.5rem;
    }

    .casetable-eval-field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .casetable-eval-field label {
      font-weight: 600;
      color: #475569;
      margin-bottom: 0.2rem;
    }

    .casetable-eval-field input {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
    }

    .casetable-eval-section h4 {
      margin: 0 0 0.35rem;
      font-size: 0.9rem;
      color: #0f172a;
    }

    .casetable-eval-cases {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .casetable-eval-case {
      border: 1px solid rgba(15, 23, 42, 0.08);
      border-radius: 6px;
      padding: 0.5rem;
      background: #f8fafc;
    }

    .casetable-eval-case-header {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      gap: 0.25rem;
      margin-bottom: 0.35rem;
    }

    .casetable-eval-case-header span {
      font-weight: 600;
      color: #0d4b91;
    }

    .casetable-eval-case-summary {
      font-size: 0.8rem;
      color: #475569;
    }

    .casetable-eval-case-fields {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 0.5rem;
      align-items: center;
    }

    .casetable-eval-toggle {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .casetable-eval-toggle span {
      font-size: 0.8rem;
      font-weight: 600;
      color: #475569;
    }

    .casetable-warning {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: #b45309;
    }

    .input-error {
      border-color: #dc2626 !important;
      background: #fef2f2;
    }

    .casetable-case-body {
      padding: 0.5rem 0.75rem 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .casetable-case-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.5rem;
    }

    .casetable-case-field {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .casetable-case-field label {
      font-weight: 600;
      color: #475569;
      margin-bottom: 0.2rem;
    }

    .casetable-case-field input {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
    }

    .structure-checkbox {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.8rem;
      color: #475569;
    }

    .structure-checkbox input {
      width: 1rem;
      height: 1rem;
    }

    .casetable-static-inputs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 0.75rem 1rem;
    }

    .casetable-static-group {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      min-width: 0;
    }

    .casetable-static-label {
      font-size: 0.8rem;
      font-weight: 600;
      color: #475569;
      margin-bottom: 0.35rem;
      display: block;
    }

    .toggle-group {
      display: inline-flex;
      border: 1px solid rgba(15, 23, 42, 0.2);
      border-radius: 999px;
      overflow: hidden;
    }

    .toggle-radio-option {
      display: inline-flex;
      position: relative;
    }

    .toggle-radio-option input {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }

    .toggle-radio-option span {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.35rem 0.9rem;
      font-size: 0.8rem;
      color: #475569;
      cursor: pointer;
    }

    .toggle-radio-option input:checked+span {
      background: #0b6fb8;
      color: #fff;
    }

    .toggle-option {
      border: none;
      background: transparent;
      padding: 0.35rem 0.9rem;
      font-size: 0.8rem;
      color: #475569;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      gap: 0;
    }

    .toggle-option.is-active {
      background: #0b6fb8;
      color: #fff;
    }

    .casetable-speed-activation {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem;
    }

    .casetable-speed-activation label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #475569;
    }

    .casetable-speed-activation select {
      min-width: 160px;
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
      background: #fff;
    }

    .casetable-help-text {
      font-size: 0.8rem;
      color: #64748b;
      margin-top: 0.35rem;
    }

    .casetable-readonly-note {
      font-size: 0.75rem;
      color: #94a3b8;
    }

    .fieldset-card {
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      padding: 0.6rem;
      background: #fff;
    }

    .fieldset-details summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: #0d4b91;
      cursor: pointer;
    }

    .fieldset-details summary::-webkit-details-marker {
      display: none;
    }

    .fieldset-summary {
      font-size: 0.8rem;
      color: #475569;
      margin-left: 0.5rem;
    }

    .fieldset-fields,
    .field-attributes {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.5rem;
    }

    .fieldset-field,
    .field-attribute {
      display: flex;
      flex-direction: column;
      font-size: 0.85rem;
    }

    .debug-hidden {
      display: none !important;
    }

    body.debug-mode .debug-hidden {
      display: flex !important;
    }

    .fieldset-field label,
    .field-attribute label {
      margin-bottom: 0.2rem;
      font-weight: 600;
      color: #475569;
    }

    .fieldset-field input,
    .field-attribute input {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.45rem;
      font-size: 0.85rem;
    }

    .field-card {
      border: 1px solid rgba(15, 23, 42, 0.12);
      border-radius: 8px;
      padding: 0.5rem;
      background: #fefefe;
      margin-top: 0.5rem;
    }

    .field-details summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      color: #0d4b91;
      cursor: pointer;
    }

    .field-details summary::-webkit-details-marker {
      display: none;
    }

    .field-summary {
      font-size: 0.8rem;
      color: #64748b;
      margin-left: 0.5rem;
    }

    .shape-section {
      margin-top: 0.5rem;
    }

    .shape-list {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .triorb-shapes-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .triorb-shape-card {
      border: 1px solid rgba(15, 23, 42, 0.15);
      border-radius: 10px;
      padding: 0.6rem;
      background: #f1f5f9;
    }

    .triorb-shape-card .shape-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .triorb-shape-card .shape-row label {
      margin: 0;
      font-weight: 600;
    }

    .triorb-shape-card .shape-details {
      margin-top: 0.6rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 0.4rem;
    }

    .triorb-shape-card input,
    .triorb-shape-card select {
      border-radius: 6px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.3rem 0.4rem;
    }

    .shape-entry {
      border: 1px dashed rgba(15, 23, 42, 0.2);
      border-radius: 6px;
      padding: 0.4rem 0.5rem;
      background: #f9fafb;
    }

    .shape-title {
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: #475569;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
    }

    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }

    .modal.active {
      display: flex;
    }

    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
    }

    .modal-window {
      position: relative;
      background: #fff;
      border-radius: 12px;
      width: min(480px, 90vw);
      max-height: 85vh;
      overflow-y: auto;
      padding: 1rem;
      box-shadow: 0 10px 40px rgba(15, 23, 42, 0.35);
    }

    #create-shape-modal #create-shape-modal-delete {
      display: none;
    }

    #create-shape-modal[data-mode="edit"] #create-shape-modal-delete {
      display: inline-flex;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    .modal-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: #0f172a;
    }

    .modal-body {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .modal-footer {
      margin-top: 1rem;
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }

    .modal-field {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .modal-field input {
      width: 100%;
    }

    .shape-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      font-size: 0.75rem;
    }

    .shape-points {
      margin-top: 0.25rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
      font-size: 0.8rem;
      color: #475569;
    }

    .shape-point {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      align-items: center;
    }

    .shape-point label {
      margin: 0;
      font-weight: 500;
    }

    .shape-point input {
      width: 5rem;
    }

    .fieldset-actions,
    .field-actions {
      margin-top: 0.5rem;
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }

    .shape-actions {
      margin-top: 0.5rem;
      display: flex;
      gap: 0.4rem;
      flex-wrap: wrap;
      justify-content: flex-start;
    }

    .fieldset-global-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 0.4rem 0.6rem;
    }

    .scanplane-actions {
      margin-top: 0.6rem;
      display: flex;
      justify-content: flex-end;
    }

    .device-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.4rem;
      font-weight: 600;
      color: #334155;
    }

    .shape-mini-btn {
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
    }

    .modal-resize-handle {
      position: absolute;
      width: 16px;
      height: 16px;
      right: 6px;
      bottom: 6px;
      cursor: se-resize;
      background: rgba(15, 23, 42, 0.35);
      border-radius: 3px;
    }

    .field-resize-handle {
      position: sticky;
      align-self: flex-end;
      margin: 0;
    }

    .replicate-modal-window {
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .replicate-modal-body {
      flex: 1;
      overflow-y: auto;
    }

    .replicate-modal-body .field-resize-handle {
      margin-top: auto;
    }

    .shape-create-window {
      max-width: 720px;
    }

    .shape-create-body .modal-section {
      margin-bottom: 0.85rem;
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .shape-polygon-group,
    .shape-rectangle-group,
    .shape-circle-group {
      display: none;
      gap: 0.35rem;
    }

    .shape-polygon-group.active,
    .shape-rectangle-group.active,
    .shape-circle-group.active {
      display: flex;
      flex-direction: column;
    }

    .shape-rectangle-group,
    .shape-circle-group {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .shape-create-body input,
    .shape-create-body textarea,
    .shape-create-body select {
      width: 100%;
    }

    .shape-create-body textarea {
      resize: vertical;
    }

    .field-create-window {
      max-width: min(960px, 75vw);
    }

    .replicate-target-group {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      margin-bottom: 0.75rem;
    }

    .replicate-target-group span {
      font-size: 0.85rem;
      font-weight: 600;
      color: #475569;
    }

    .replicate-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.6rem;
    }

    .replicate-grid label {
      display: flex;
      flex-direction: column;
      font-weight: 600;
      gap: 0.3rem;
    }

    .replicate-grid input,
    .replicate-grid select {
      font-weight: normal;
    }

    .replicate-modal-window[data-replicate-target="case"] [data-target-section="fieldset"] {
      display: none;
    }

    .replicate-modal-window[data-replicate-target="fieldset"] [data-target-section="case"] {
      display: none;
    }

    .replicate-note {
      font-size: 0.85rem;
      color: #475569;
      margin-top: 0.5rem;
    }

    .field-create-body .modal-section {
      margin-bottom: 0.85rem;
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .field-create-body input,
    .field-create-body select {
      width: 100%;
    }

    .field-create-grid {
      display: flex;
      flex-flow: nowrap row;
      justify-content: space-around;
      gap: 1rem;
    }

    .field-create-grid .field-create-column {
      flex: flex;
      justify-content: space-around;
    }

    .field-create-column {
      border: 1px solid rgba(15, 23, 42, 0.1);
      border-radius: 10px;
      padding: 0.75rem;
      background: #fbfbfd;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .field-create-column h4 {
      margin: 0;
      font-size: 0.95rem;
    }

    .shape-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      max-height: 140px;
      overflow-y: auto;
    }

    .shape-list-group {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .shape-list button {
      padding: 0.4rem 0.6rem;
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .shape-list .shape-type {
      font-size: 0.65rem;
      color: #94a3b8;
    }

    .shape-create-window .two-column {
      display: grid;
      gap: 0.5rem;
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .fieldset-checkbox-grid {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      max-height: 180px;
      overflow-y: auto;
    }

    .toggle-pill-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      max-height: 220px;
      overflow-y: auto;
    }

    .toggle-pill-btn {
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      background: #f8fafc;
      color: #0f172a;
      font-size: 0.85rem;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
    }

    .toggle-pill-btn.active {
      background: #0b6fb8;
      color: #ffffff;
      border-color: transparent;
      transform: translateY(-1px);
    }

    .toggle-pill-empty {
      color: #475569;
      font-size: 0.9rem;
    }

    .preview-note {
      font-size: 0.85rem;
      color: #c53030;
    }

    .plot-overlay-controls {
      position: absolute;
      top: 2rem;
      right: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .plot-wrapper {
      position: relative;
    }

    footer {
      text-align: center;
      font-size: 0.85rem;
      color: #4a5568;
      margin-bottom: 2rem;
    }

    @media (max-width: 960px) {
      main {
        flex-direction: column;
      }

      .side-menu {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div id="shape-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-action="close-modal"></div>
    <div class="modal-window" role="dialog" aria-modal="true">
      <div class="modal-header">
        <span class="modal-title" id="shape-modal-title"></span>
        <button type="button" class="inline-btn inline-danger shape-mini-btn" id="shape-modal-close">
          ×
        </button>
      </div>
      <div class="modal-body" id="shape-modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="inline-btn secondary" id="shape-modal-cancel">Cancel</button>
        <button type="button" class="inline-btn" id="shape-modal-save">Save</button>
      </div>
    </div>
  </div>
  <div id="create-shape-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-action="close-create-shape"></div>
    <div class="modal-window shape-create-window" role="dialog" aria-modal="true">
      <div class="modal-header">
        <span class="modal-title">Add Shape</span>
        <button type="button" class="inline-btn inline-danger shape-mini-btn" id="create-shape-modal-close">
          ×
        </button>
      </div>
      <div class="modal-body shape-create-body">
        <div class="modal-section">
          <label>Name</label>
          <input type="text" id="create-shape-name" placeholder="Shape name" />
        </div>
        <div class="modal-section two-column">
          <label>Fieldtype</label>
          <select id="create-shape-fieldtype">
            <option value="ProtectiveSafeBlanking">ProtectiveSafeBlanking</option>
            <option value="WarningSafeBlanking">WarningSafeBlanking</option>
          </select>
          <label>Type</label>
          <select id="create-shape-kind">
            <option value="Field">Field</option>
            <option value="CutOut">CutOut</option>
          </select>
          <label>Shape Type</label>
          <select id="create-shape-type">
            <option value="Polygon">Polygon</option>
            <option value="Rectangle">Rectangle</option>
            <option value="Circle">Circle</option>
          </select>
        </div>
        <div class="modal-section" id="create-shape-dimension-fields">
          <div class="shape-polygon-group">
            <label>Polygon points (format: (x,y),(x,y))</label>
            <textarea id="create-shape-points" rows="3"></textarea>
          </div>
          <div class="shape-dimension-grid shape-rectangle-group" data-shape="rectangle">
            <label>OriginX</label>
            <input type="number" id="create-rect-originx" value="0" />
            <label>OriginY</label>
            <input type="number" id="create-rect-originy" value="0" />
            <label>Width</label>
            <input type="number" id="create-rect-width" value="100" />
            <label>Height</label>
            <input type="number" id="create-rect-height" value="100" />
            <label>Rotation</label>
            <input type="number" id="create-rect-rotation" value="0" />
          </div>
          <div class="shape-dimension-grid shape-circle-group" data-shape="circle">
            <label>CenterX</label>
            <input type="number" id="create-circle-centerx" value="0" />
            <label>CenterY</label>
            <input type="number" id="create-circle-centery" value="0" />
            <label>Radius</label>
            <input type="number" id="create-circle-radius" value="100" />
          </div>
        </div>
        <div class="modal-section">
          <label>Attach to Fieldsets</label>
          <div id="create-shape-fieldset-list" class="toggle-pill-grid"></div>
        </div>
        <div class="modal-section preview-note">
          <p>Live preview will be shown as a red overlay while editing.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="inline-btn inline-danger" id="create-shape-modal-delete" hidden>
          Delete
        </button>
        <button type="button" class="inline-btn secondary" id="create-shape-modal-cancel">Cancel</button>
        <button type="button" class="inline-btn" id="create-shape-modal-save">Add Shape</button>
      </div>
    </div>
  </div>
  <div id="create-field-modal" class="modal" aria-hidden="true" data-mode="create">
    <div class="modal-backdrop" data-action="close-create-field"></div>
    <div class="modal-window field-create-window" role="dialog" aria-modal="true">
      <div class="modal-header">
        <span class="modal-title">Add Field</span>
        <button type="button" class="inline-btn inline-danger shape-mini-btn" id="create-field-modal-close">
          ✕
        </button>
      </div>
      <div class="modal-body field-create-body">
        <div class="modal-section">
          <label>Fieldset Name</label>
          <input type="text" id="create-field-fieldset-name" placeholder="Fieldset name" />
        </div>
        <div class="modal-section">
          <label>Fieldset Latin9 Key</label>
          <input type="text" id="create-field-fieldset-latin9" placeholder="_FSN000_0000" />
        </div>
        <div class="modal-section field-create-grid">
          <div class="field-create-column">
            <h4>Field 1 (Protective)</h4>
            <label>
              Field Name
              <input type="text" id="create-field-name-0" placeholder="Field 1 name" />
            </label>
            <div class="shape-list-group">
              <p>Type = Field</p>
              <div class="shape-list" id="create-field-shape-list-0-field"></div>
            </div>
            <div class="shape-list-group">
              <p>Type = CutOut</p>
              <div class="shape-list" id="create-field-shape-list-0-cutout"></div>
            </div>
          </div>
          <div class="field-create-column">
            <h4>Field 2 (Warning)</h4>
            <label>
              Field Name
              <input type="text" id="create-field-name-1" placeholder="Field 2 name" />
            </label>
            <div class="shape-list-group">
              <p>Type = Field</p>
              <div class="shape-list" id="create-field-shape-list-1-field"></div>
            </div>
            <div class="shape-list-group">
              <p>Type = CutOut</p>
              <div class="shape-list" id="create-field-shape-list-1-cutout"></div>
            </div>
          </div>
        </div>
        <div class="modal-section preview-note">
          <p>Selected shapes render on the Plotly canvas in red preview while editing.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="inline-btn secondary" id="create-field-modal-cancel">
          Cancel
        </button>
        <button type="button" class="inline-btn" id="create-field-modal-save">OK</button>
      </div>
    </div>
  </div>
  <div id="replicate-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-action="close-replicate-modal"></div>
    <div class="modal-window replicate-modal-window" role="dialog" aria-modal="true" data-replicate-target="fieldset">
      <div class="modal-header">
        <span class="modal-title">Replicate Fields</span>
        <button type="button" class="inline-btn inline-danger shape-mini-btn" id="replicate-modal-close">
          ×
        </button>
      </div>
      <div class="modal-body replicate-modal-body">
        <div class="replicate-target-group" id="replicate-target-toggle">
          <span>Target</span>
          <div class="toggle-group">
            <button type="button" class="toggle-option is-active" data-replicate-target="fieldset">
              Fieldset
            </button>
            <button type="button" class="toggle-option" data-replicate-target="case">
              Case
            </button>
          </div>
        </div>
        <div class="replicate-grid">
          <label data-target-section="fieldset">
            Fieldset
            <select id="replicate-fieldset-select"></select>
          </label>
          <label data-target-section="case">
            Source Cases
            <select id="replicate-case-select" multiple size="6"></select>
          </label>
          <label>
            Copies
            <input type="number" id="replicate-copy-count" min="1" max="32" step="1" value="1" />
          </label>
          <label>
            Offset X (mm / copy)
            <input type="number" id="replicate-offset-x" step="1" value="0" />
          </label>
          <label>
            Offset Y (mm / copy)
            <input type="number" id="replicate-offset-y" step="1" value="0" />
          </label>
          <label>
            Rotation (° / copy)
            <input type="number" id="replicate-rotation" step="1" value="0" />
          </label>
          <label>
            Scale (％ / copy)
            <input type="number" id="replicate-scale-percent" step="1" value="0" />
          </label>
          <label class="replicate-option">
            <input type="checkbox" id="replicate-include-cutouts" />
            Type = CutOut の Shape も複製する
          </label>
          <label class="replicate-option">
            <input type="checkbox" id="replicate-preserve-orientation" />
            回転複製時に図形の姿勢を維持する(改善作業中)
          </label>
          <label class="replicate-option" data-target-section="case">
            <input type="checkbox" id="replicate-static-inputs-auto" />
            Case 複製時に StaticInputs を Low/High へ自動加算する
          </label>
          <label data-target-section="case">
            SpeedRange Min (加算値 / copy)
            <input type="number" id="replicate-speed-min-step" step="10" value="0" />
          </label>
          <label data-target-section="case">
            SpeedRange Max (加算値 / copy)
            <input type="number" id="replicate-speed-max-step" step="10" value="0" />
          </label>
          <label>
            Fieldset / Case prefix
            <input type="text" id="replicate-case-prefix" placeholder="Fieldset" />
          </label>
        </div>
        <p class="replicate-note">
          Target を Fieldset にすると選択した Fieldset 配下の Field をまとめてコピーし、コピーごとに新しい Fieldset と Case を追加します（オフセット／
          回転／スケール／CutOut 設定が適用され、入力変更時は Plotly に青いプレビューが表示されます）。Target を Case にすると Ctrl / Cmd や Shift
          で複数選択した Case を Copies 倍で複製します（例: Case を 2 件選択し Copies=4 の場合は 8 件生成）。Case ターゲットでも紐づく Fieldset
          が同じパラメータで複製され、入力値に応じたプレビューが Plotly に表示されます。
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="inline-btn secondary" id="replicate-modal-cancel">Cancel</button>
        <button type="button" class="inline-btn" id="replicate-modal-apply">Apply</button>
      </div>
    </div>
  </div>
  <!-- アプリ全体のヘッダー領域 -->
  <header>
    <h1>TriOrb - SICK SLS Editor</h1>
  </header>
  <!-- メインレイアウト：左に Plotly 表示、右に設定メニュー -->
  <main>
    <section class="content-area">
      <!-- 図形の追加・保存などのツール系 UI -->
      <div class="toolbar">
        <div class="toolbar-primary">
          <button id="btn-new" type="button">New</button>
          <button id="btn-save-triorb" type="button" class="secondary">Save (TriOrb)</button>
          <button id="btn-save-sick" type="button" class="inline-btn">Save (SICK)</button>
          <label class="upload-btn">
            Load (XML)
            <input id="file-input" type="file" accept=".xml,.sgexml" />
          </label>
          <span id="status-text">Ready</span>
        </div>
        <div class="toolbar-toggle">
          <button id="btn-toggle-legend" type="button" class="legend-toggle-btn">Hide Legend</button>
        </div>
      </div>
      <div class="plot-wrapper">
        <div id="plot"></div>
        <div class="plot-overlay-controls">
          <button id="btn-add-shape-overlay" type="button">+ Shape</button>
          <button id="btn-add-field-overlay" type="button">+ Field</button>
          <button id="btn-replicate-field" type="button">Replicate</button>
        </div>
      </div>
      <div class="case-filter">
        <div class="fieldset-filter-controls">
          <button type="button" class="inline-btn" id="btn-case-check-all">Show All Cases</button>
          <button type="button" class="inline-btn" id="btn-case-uncheck-all">Hide All Cases</button>
        </div>
        <div id="case-checkboxes"></div>
      </div>
      <div class="fieldset-filter">
        <div class="fieldset-filter-controls">
          <button type="button" class="inline-btn" id="btn-fieldset-check-all">All check</button>
          <button type="button" class="inline-btn" id="btn-fieldset-uncheck-all">All uncheck</button>
        </div>
        <div id="fieldset-checkboxes"></div>
      </div>
      <div class="triorb-shape-filter">
        <div class="fieldset-filter-controls">
          <button type="button" class="inline-btn" id="btn-triorb-shape-check-all">Show All Shapes</button>
          <button type="button" class="inline-btn" id="btn-triorb-shape-uncheck-all">Hide All Shapes</button>
        </div>
        <div id="triorb-shape-checkboxes"></div>
      </div>
    </section>
    <!-- サイドメニュー: XML構造を表示する領域 -->
    <aside class="side-menu">
      <h2>Structure Menu</h2>
      {% for item in menu_items %}
      <details class="menu-section" {% if loop.first and item.tag !="FileInfo" %}open{% endif %}>
        <summary>{{ item.tag }}</summary>
        <div class="menu-content">
          {% if item.tag == "FileInfo" %}
          <p class="menu-description">{{ item.summary }}</p>
          {% if fileinfo_fields %}
          <div class="menu-fileinfo-grid" data-scope="fileinfo">
            {% for field in fileinfo_fields %}
            <div class="menu-fileinfo-field">
              <label for="fileinfo-{{ field.tag }}">{{ field.tag }}</label>
              <input id="fileinfo-{{ field.tag }}" type="text" value="{{ field.value }}" data-field="{{ field.tag }}" />
            </div>
            {% endfor %}
          </div>
          {% else %}
          <p>No FileInfo entries.</p>
          {% endif %}
          {% elif item.tag == "Export_ScanPlanes" %}
          <p class="menu-description">{{ item.summary }}</p>
          <button type="button" class="inline-btn" id="btn-add-scanplane">Add ScanPlane</button>
          <div class="scanplanes-editor" id="scanplanes-editor"></div>
          {% elif item.tag == "Export_FieldsetsAndFields" %}
          <p class="menu-description">{{ item.summary }}</p>
          <button type="button" class="inline-btn" id="btn-add-fieldset">Add Fieldset</button>
          <details class="menu-section" id="fieldset-global-section">
            <summary>GlobalGeometry</summary>
            <div class="menu-content">
              <div class="fieldset-global-grid" id="fieldset-global"></div>
            </div>
          </details>
          <details class="menu-section" id="fieldset-devices-section">
            <summary>Devices</summary>
            <div class="menu-content">
              <div class="fieldset-actions">
                <button type="button" class="inline-btn" id="btn-add-fieldset-device">
                  Add Device
                </button>
              </div>
              <div class="fieldsets-editor" id="fieldset-devices"></div>
            </div>
          </details>
          <div class="fieldsets-editor" id="fieldsets-editor"></div>
          {% elif item.tag == "Export_CasetablesAndCases" %}
          <div class="casetable-section">
            <h3>Configuration</h3>
            <div class="casetable-configuration" id="casetable-configuration"></div>
          </div>
          <div class="casetable-section">
            <div class="casetable-cases-header">
              <h3>Cases</h3>
              <button type="button" class="inline-btn" id="btn-add-case">Add Case</button>
              <span class="casetable-case-count" id="casetable-case-count"></span>
            </div>
            <div class="casetable-cases-list" id="casetable-cases"></div>
            <p class="casetable-help-text">Up to 128 monitoring cases can be defined.</p>
          </div>
          <div class="casetable-section">
            <div class="casetable-evals-header">
              <h3>Evals</h3>
              <button type="button" class="inline-btn" id="btn-add-eval">Add Eval</button>
              <span class="casetable-eval-count" id="casetable-eval-count"></span>
            </div>
            <div class="casetable-evals-list" id="casetable-evals"></div>
            <p class="casetable-help-text">
              Eval cases stay aligned with the Cases tree. UserFieldId values must map to the TriOrb shape indices
              (1-based) or the trailing preset slots when no shapes exist.
            </p>
            <p class="casetable-warning" id="casetable-evals-warning"></p>
          </div>
          <div class="casetable-section">
            <h3>FieldsConfiguration</h3>
            <p class="fields-config-note">
              ScanPlanes / Fieldsets から自動生成されるため、編集はできません。
            </p>
            <div class="casetable-fields-configuration" id="casetable-fields-configuration"></div>
          </div>
          {% else %}
          <p>{{ item.summary }}</p>
          {% endif %}
        </div>
      </details>
      {% endfor %}
      <h2>TriOrb Menu</h2>
      <details class="menu-section">
        <summary>Device</summary>
        <div class="menu-content">
          <div class="menu-fileinfo-grid">
            <div class="triorb-field">
              <label>FieldOfView</label>
              <input type="number" id="triorb-field-of-view" value="270" min="1" max="360" step="1" />
            </div>
          </div>
        </div>
      </details>
      <details class="menu-section">
        <summary>Shapes</summary>
        <div class="menu-content">
          <div class="fieldset-actions">
            <button type="button" class="inline-btn" id="btn-add-triorb-shape">
              Add Shape
            </button>
          </div>
          <div class="triorb-shapes-list" id="triorb-shapes-list"></div>
        </div>
      </details>
      <details class="menu-section">
        <summary>Common</summary>
        <div class="menu-content">
          <div class="menu-fileinfo-grid">
            <div class="triorb-field">
              <label>MultipleSampling (2-16)</label>
              <input id="global-multiple-sampling" type="number" min="2" max="16" value="2" />
            </div>
            <div class="triorb-field">
              <label>Resolution</label>
              <input id="global-resolution" type="number" min="1" max="1000" value="70" />
            </div>
            <div class="triorb-field">
              <label>TolerancePositive</label>
              <input id="global-tolerance-positive" type="number" value="0" />
            </div>
            <div class="triorb-field">
              <label>ToleranceNegative</label>
              <input id="global-tolerance-negative" type="number" value="0" />
            </div>
          </div>
          <details class="menu-section">
            <summary>CommonCutOut #1</summary>
            <div class="menu-content">
              <ul>
                <li>Polygon #1</li>
                <li>Circle #1</li>
                <li>Rectangle #1</li>
              </ul>
            </div>
          </details>
        </div>
      </details>
    </aside>
  </main>
  <footer>Flask + Plotly powered preview</footer>


  <script>
    window.appBootstrapData = {
      defaultFigure: {{ plot_spec | tojson }},
    rootAttributes: {{ root_attrs | tojson }},
    scanPlanes: {{ scan_planes | tojson }},
    fieldsets: {{ fieldsets | tojson }},
    casetablePayload: {{ casetable_payload | tojson }},
    triorbShapes: {{ triorb_shapes | tojson }},
    triorbSource: {{ triorb_source | tojson }},
  };
  </script>
  <script
    type="module"
    src="{{ url_for('static', filename='js/app.js') }}"
  ></script>
</body>

</html>